# Stage 0 (MVP) — Baseline Report

Первый полный прогон пайплайна (данные → индикаторы → сигналы → бэктест) зафиксирован 17 ноября 2025. Результаты будут служить точкой отсчёта перед подключением ГА и новых индикаторов.

## Использованная конфигурация

- `config/mvp_strategy_config.yaml`
  - RSI 14 / пороги 35/65, MACD 12-26-9, Bollinger 20×2σ, WOBI z-score.
  - Весовое голосование 1:1:1:1, Entry threshold 0.5, Exit 0.1.
  - Stop-loss 1%, Take-profit 2%, max holding 96 баров (≈ сутки).
  - Комиссии биржи: **maker 0.02%** (лимитные входы/тейк-профиты), **taker 0.07%** (экстренные выходы — стоп, time-stop).
- Скрипт: `scripts/run_mvp_backtest.py --output-dir results/stage0_baseline`
- Dataset: `df_btc_15m_complete.csv` (BTCUSDT, 15m, Jan-2024 → Feb-2025).

## Метрики

| Split | Total PnL | Return | Sharpe | Max DD | Win% | Profit Factor | Trades |
| --- | --- | --- | --- | --- | --- | --- | --- |
| Train | -6 810 USDT | -68.1% | -12.56 | 72.1% | 50.3% | 0.77 | 1 832 |
| Val | -352 USDT | -3.5% | -1.28 | 10.8% | 50.5% | 0.97 | 394 |
| Test | -865 USDT | -8.7% | -4.70 | 15.6% | 51.9% | 0.91 | 377 |
| Full | -7 180 USDT | -71.8% | -9.68 | 73.8% | 50.6% | 0.80 | 2 603 |

### Эксперимент: быстрый запуск ГА (6×3)

Чтобы проверить связку `genetic_optimizer` ↔ `simple_backtester`, запустили короткий прогон:

```
py -3 scripts/run_ga_search.py --population-size 6 --max-generations 3 --output results/ga_best.json
```

- Лучший геном: `rsi_period=25`, `stop_loss_pct=1.48%`, `take_profit_pct=3.34%`, `atr_period=16`, `atr_stop_multiplier=2.92`, `atr_trailing_multiplier=1.98`, `wobi_weight=0.45`
- Валид. метрики: `return -1.97%`, `Sharpe -10.0`, `max DD 7.4%`, `PF 0.83`, `23` сделок
- На тесте при тех же параметрах `Sharpe 33.5` и `PF 1.72`, но train/full остаются отрицательными (overfit/low sample)

Вывод: пайплайн ГА → бэктест работает, но потребуется больше поколений и штрафы за turnover/нестабильность, чтобы получить устойчивый результат.

Файлы с деталями: `results/stage0_baseline/metrics_summary.json`, `trades_<split>.csv` (игнорируются гитом, но доступны локально).

## Выводы

1. **Комиссии «съели» большую часть гипотетической доходности.** Даже при лимитных входах/выходах maker 0.02% + taker 0.07% превращают стратегию в отрицательную. Нужно сокращать количество сделок, повышать средний RR и ловить движения > комиссий.
2. **Высокая просадка.** Max Drawdown вырос до 70%+ (бо́льшая часть train/full). Текущая связка SL/TP/time-stop + равный вес индикаторов слишком чувствительна к шуму.
3. **Win Rate чуть выше 50%, Profit Factor < 1.** Без серьёзного edge каждая комиссия ухудшает результат → актуально повышать precision сигналов и вводить фильтры режимов.
4. **WOBI требуется калибровка.** Order book-сигнал без адаптивных весов увеличивает количество сделок, но не добавляет качества; нужно оптимизировать веса/порог z-score и совмещать с regime detection.

## Следующие шаги

1. Подключить ГА к конфигу и начать оптимизацию базовых параметров (RSI period, веса, SL/TP) с учётом комиссий.
2. Добавить адаптивный риск-менеджмент (ATR-стопы, трейлинг, перевод в безубыток) и фильтры режимов, чтобы сократить число сделок.
3. Ввести штрафы за turnover / количество сделок в fitness, чтобы ГА искал более «дорогие» сигналы.
4. Провести анализ чувствительности по комиссиям (maker/taker) и определить минимальный RR, при котором стратегия остаётся работоспособной.

Документ будет обновляться после каждого значимого прогона.

