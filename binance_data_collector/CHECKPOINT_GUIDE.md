# ðŸ’¾ Ð ÑƒÐºÐ¾Ð²Ð¾Ð´ÑÑ‚Ð²Ð¾ Ð¿Ð¾ Checkpoint-Ð°Ð¼

Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° checkpoint-Ð¾Ð² Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÑ‚ÑŒ Ð¿Ñ€Ð¾Ð³Ñ€ÐµÑÑ ÑÐ±Ð¾Ñ€Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¸ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°Ñ‚ÑŒ ÐµÐ³Ð¾ Ð¿Ð¾ÑÐ»Ðµ Ð¾ÑˆÐ¸Ð±Ð¾Ðº Ð¸Ð»Ð¸ Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ¸ IP.

## ðŸŽ¯ Ð§Ñ‚Ð¾ ÑÑ‚Ð¾ Ð´Ð°ÐµÑ‚:

1. **ÐŸÐµÑ€Ð¸Ð¾Ð´Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ** - Ð´Ð°Ð½Ð½Ñ‹Ðµ ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÑŽÑ‚ÑÑ ÐºÐ°Ð¶Ð´Ñ‹Ðµ N Ð±Ð°Ñ‚Ñ‡ÐµÐ¹
2. **ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ** - Ð¿Ð¾ÑÐ»Ðµ Ð¿ÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐºÐ° ÑÐ±Ð¾Ñ€ Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶Ð°ÐµÑ‚ÑÑ Ñ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ checkpoint
3. **Ð—Ð°Ñ‰Ð¸Ñ‚Ð° Ð¾Ñ‚ Ð¿Ð¾Ñ‚ÐµÑ€Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ñ…** - Ð¿Ñ€Ð¸ Ð±Ð°Ð½Ð½Ðµ IP Ð¸Ð»Ð¸ Ð¾ÑˆÐ¸Ð±ÐºÐ°Ñ… Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð½Ðµ Ñ‚ÐµÑ€ÑÑŽÑ‚ÑÑ
4. **ÐŸÑ€Ð¾Ð·Ñ€Ð°Ñ‡Ð½Ð°Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ð°** - Ð²ÑÐµ Ð¿Ñ€Ð¾Ð¸ÑÑ…Ð¾Ð´Ð¸Ñ‚ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸

## ðŸ“Š ÐšÐ¾Ð³Ð´Ð° ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÑŽÑ‚ÑÑ checkpoint-Ñ‹:

1. **OHLCV Ð´Ð°Ð½Ð½Ñ‹Ðµ** - ÑÑ€Ð°Ð·Ñƒ Ð¿Ð¾ÑÐ»Ðµ Ð¿Ð¾Ð»Ð½Ð¾Ð³Ð¾ ÑÐ±Ð¾Ñ€Ð° (Ð±Ñ‹ÑÑ‚Ñ€Ð¾, ~1 Ð¼Ð¸Ð½ÑƒÑ‚Ð°)
2. **Aggregated Trades** - ÐºÐ°Ð¶Ð´Ñ‹Ðµ 10,000 Ð±Ð°Ñ‚Ñ‡ÐµÐ¹ (Ð¸Ð»Ð¸ Ð´Ñ€ÑƒÐ³Ð¾Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ñ‡ÐµÑ€ÐµÐ· `--checkpoint-interval`)
3. **ÐŸÑ€Ð¸ Ð¾ÑˆÐ¸Ð±ÐºÐ°Ñ… API** - Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð¿ÐµÑ€ÐµÐ´ Ð¾Ð¶Ð¸Ð´Ð°Ð½Ð¸ÐµÐ¼ Ñ€Ð°Ð·Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ¸
4. **Ð¤Ð¸Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ checkpoint** - Ð¿Ð¾ÑÐ»Ðµ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾Ð³Ð¾ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ Ð²ÑÐµÑ… ÑˆÐ°Ð³Ð¾Ð²

## ðŸš€ Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ

### Ð‘Ð°Ð·Ð¾Ð²Ñ‹Ð¹ Ð·Ð°Ð¿ÑƒÑÐº (Ñ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¼Ð¸ checkpoint-Ð°Ð¼Ð¸):

```bash
python scripts/collect_comprehensive_data.py \
    --start-date 2024-01-01 \
    --end-date 2025-11-02 \
    --interval 15m \
    --target-interval 1h
```

Checkpoint-Ñ‹ ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÑŽÑ‚ÑÑ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ñ Ð¸Ð¼ÐµÐ½ÐµÐ¼:
```
{BYMBOL}_{START_DATE}_{END_DATE}_{TARGET_INTERVAL}
```

ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: `BTCUSDT_20240101_20251102_1h`

### Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¸Ð· checkpoint:

```bash
python scripts/collect_comprehensive_data.py \
    --resume BTCUSDT_20240101_20251102_1h
```

### ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð¸Ð½Ñ‚ÐµÑ€Ð²Ð°Ð»Ð° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ:

```bash
python scripts/collect_comprehensive_data.py \
    --checkpoint-interval 5000  # Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÑ‚ÑŒ ÐºÐ°Ð¶Ð´Ñ‹Ðµ 5000 Ð±Ð°Ñ‚Ñ‡ÐµÐ¹
```

### Ð£ÐºÐ°Ð·Ð°Ð½Ð¸Ðµ ÑÐ²Ð¾ÐµÐ³Ð¾ Ð¸Ð¼ÐµÐ½Ð¸ checkpoint:

```bash
python scripts/collect_comprehensive_data.py \
    --checkpoint-name my_custom_checkpoint
```

## ðŸ“ Ð“Ð´Ðµ Ñ…Ñ€Ð°Ð½ÑÑ‚ÑÑ checkpoint-Ñ‹:

```
binance_data_collector/data/checkpoints/
â”œâ”€â”€ {CHECKPOINT_NAME}_ohlcv.pkl          # OHLCV Ð´Ð°Ð½Ð½Ñ‹Ðµ
â”œâ”€â”€ {CHECKPOINT_NAME}_ohlcv_metadata.json
â”œâ”€â”€ {CHECKPOINT_NAME}_trades.pkl         # Aggregated trades (Ð² Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐµ)
â”œâ”€â”€ {CHECKPOINT_NAME}_trades_metadata.json
â””â”€â”€ {CHECKPOINT_NAME}_final.pkl          # Ð¤Ð¸Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ
    â””â”€â”€ {CHECKPOINT_NAME}_final_metadata.json
```

## ðŸ”„ ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ

ÐŸÑ€Ð¸ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð½Ð¾Ð¼ Ð·Ð°Ð¿ÑƒÑÐºÐµ Ñ Ñ‚ÐµÐ¼ Ð¶Ðµ `checkpoint_name`:
- âœ… ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð·Ð°Ð³Ñ€ÑƒÐ¶Ð°ÑŽÑ‚ÑÑ OHLCV Ð´Ð°Ð½Ð½Ñ‹Ðµ
- âœ… ÐŸÑ€Ð¾Ð´Ð¾Ð»Ð¶Ð°ÐµÑ‚ÑÑ ÑÐ±Ð¾Ñ€ Ð°Ð³Ñ€ÐµÐ³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ñ… ÑÐ´ÐµÐ»Ð¾Ðº Ñ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ¹ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¸
- âœ… Ð’ÑÐµ Ð¾ÑÑ‚Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ ÑÐ¾Ð±Ð¸Ñ€Ð°ÑŽÑ‚ÑÑ Ð·Ð°Ð½Ð¾Ð²Ð¾ (Ð¾Ð½Ð¸ Ð±Ñ‹ÑÑ‚Ñ€Ñ‹Ðµ)

## âš ï¸ ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¾ÑˆÐ¸Ð±Ð¾Ðº

### Ð‘Ð°Ð½ IP:
- Checkpoint Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÐµÑ‚ÑÑ
- Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ð¶Ð´ÐµÑ‚ Ñ€Ð°Ð·Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ¸ (Ð¸Ð·Ð²Ð»ÐµÐºÐ°ÐµÑ‚ Ð²Ñ€ÐµÐ¼Ñ Ð¸Ð· Ð¾ÑˆÐ¸Ð±ÐºÐ¸)
- ÐŸÐ¾ÑÐ»Ðµ Ñ€Ð°Ð·Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ¸ Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶Ð°ÐµÑ‚ Ñ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ checkpoint

### Rate Limit:
- Ð£Ð²ÐµÐ»Ð¸Ñ‡Ð¸Ð²Ð°ÐµÑ‚ÑÑ Ð·Ð°Ð´ÐµÑ€Ð¶ÐºÐ° Ð¼ÐµÐ¶Ð´Ñƒ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ°Ð¼Ð¸
- Checkpoint ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÐµÑ‚ÑÑ
- ÐŸÑ€Ð¾Ð´Ð¾Ð»Ð¶ÐµÐ½Ð¸Ðµ Ð¿Ð¾ÑÐ»Ðµ Ð¿Ð°ÑƒÐ·Ñ‹

### ÐšÑ€Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð¾ÑˆÐ¸Ð±ÐºÐ¸:
- ÐŸÑ€Ð¾Ð³Ñ€ÐµÑÑ ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÐµÑ‚ÑÑ Ð² checkpoint
- ÐœÐ¾Ð¶Ð½Ð¾ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ð²Ñ€ÑƒÑ‡Ð½ÑƒÑŽ Ñ‡ÐµÑ€ÐµÐ· `--resume`

## ðŸ’¡ ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹

### Ð¡Ð±Ð¾Ñ€ Ð¼Ð°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¿ÐµÑ€Ð¸Ð¾Ð´Ð° Ñ checkpoint-Ð°Ð¼Ð¸:

```bash
# ÐŸÐµÑ€Ð²Ñ‹Ð¹ Ð·Ð°Ð¿ÑƒÑÐº - Ð½Ð°Ñ‡Ð½ÐµÑ‚ ÑÐ±Ð¾Ñ€
python scripts/collect_comprehensive_data.py \
    --start-date 2017-08-01 \
    --end-date 2025-11-02 \
    --checkpoint-name btc_full_history

# Ð•ÑÐ»Ð¸ Ð¿Ñ€ÐµÑ€Ð²Ð°Ð»Ð¾ÑÑŒ - Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ð·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚Ðµ ÑÐ½Ð¾Ð²Ð° (Ñ‚Ð¾Ñ‚ Ð¶Ðµ checkpoint-name):
python scripts/collect_comprehensive_data.py \
    --start-date 2017-08-01 \
    --end-date 2025-11-02 \
    --checkpoint-name btc_full_history

# Ð˜Ð»Ð¸ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚Ðµ ÑÐ²Ð½Ð¾:
python scripts/collect_comprehensive_data.py \
    --resume btc_full_history
```

### Ð’ Jupyter Notebook:

```python
# Ð’ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð°Ñ… ÑƒÐºÐ°Ð¶Ð¸Ñ‚Ðµ:
USE_CHECKPOINTS = True
CHECKPOINT_NAME = "BTCUSDT_20240101_20251102_1h"  # Ð¸Ð»Ð¸ None Ð´Ð»Ñ Ð°Ð²Ñ‚Ð¾
CHECKPOINT_INTERVAL = 10000

# ÐŸÑ€Ð¸ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ð¸:
from binance_data_collector.scripts.collect_comprehensive_data import resume_from_checkpoint
df = resume_from_checkpoint("BTCUSDT_20240101_20251102_1h")
```

## ðŸ“Š ÐžÑ†ÐµÐ½ÐºÐ° Ñ€Ð°Ð·Ð¼ÐµÑ€Ð° checkpoint-Ð¾Ð²

- **OHLCV checkpoint**: ~50-100 MB (64k ÑÐ²ÐµÑ‡ÐµÐ¹)
- **Trades checkpoint**: ~500-700 MB Ð½Ð° ÐºÐ°Ð¶Ð´Ñ‹Ðµ 50,000 Ð±Ð°Ñ‚Ñ‡ÐµÐ¹
- **Ð¤Ð¸Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ checkpoint**: ~1-2 GB (Ð²ÑÐµ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¾Ð±ÑŠÐµÐ´Ð¸Ð½ÐµÐ½Ñ‹)

## ðŸ” ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ñ… checkpoint-Ð¾Ð²

```python
from pathlib import Path
from binance_data_collector.config import config
import json

checkpoint_dir = config.DATA_DIR / "checkpoints"

# Ð¡Ð¿Ð¸ÑÐ¾Ðº Ð²ÑÐµÑ… checkpoint-Ð¾Ð²
for pkl_file in checkpoint_dir.glob("*_metadata.json"):
    with open(pkl_file, 'r') as f:
        meta = json.load(f)
    print(f"{pkl_file.stem.replace('_metadata', '')}")
    print(f"  ÐŸÐµÑ€Ð¸Ð¾Ð´: {meta.get('start_date')} - {meta.get('end_date')}")
    print(f"  Ð¨Ð°Ð³: {meta.get('step')}")
    print()
```

## âœ… ÐŸÑ€ÐµÐ¸Ð¼ÑƒÑ‰ÐµÑÑ‚Ð²Ð°

- âœ… ÐÐµ Ð½ÑƒÐ¶Ð½Ð¾ Ð¿ÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐºÐ°Ñ‚ÑŒ ÑÐ±Ð¾Ñ€ Ñ Ð½Ð°Ñ‡Ð°Ð»Ð° Ð¿Ñ€Ð¸ Ð¾ÑˆÐ¸Ð±ÐºÐ°Ñ…
- âœ… Ð”Ð°Ð½Ð½Ñ‹Ðµ ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÑŽÑ‚ÑÑ Ð¿ÐµÑ€Ð¸Ð¾Ð´Ð¸Ñ‡ÐµÑÐºÐ¸
- âœ… ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð±Ð°Ð½Ð¾Ð² IP
- âœ… ÐœÐ¾Ð¶Ð½Ð¾ Ð¾ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ð¸ Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶Ð¸Ñ‚ÑŒ Ð¿Ð¾Ð·Ð¶Ðµ
- âœ… ÐŸÑ€Ð¾Ð·Ñ€Ð°Ñ‡Ð½Ð°Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ð° - Ð²ÑÐµ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸

## âš ï¸ Ð’Ð°Ð¶Ð½Ð¾

- Checkpoint-Ñ‹ Ð·Ð°Ð½Ð¸Ð¼Ð°ÑŽÑ‚ Ð¼ÐµÑÑ‚Ð¾ Ð½Ð° Ð´Ð¸ÑÐºÐµ
- Ð¡Ñ‚Ð°Ñ€Ñ‹Ðµ checkpoint-Ñ‹ Ð¼Ð¾Ð¶Ð½Ð¾ ÑƒÐ´Ð°Ð»ÑÑ‚ÑŒ Ð¿Ð¾ÑÐ»Ðµ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾Ð³Ð¾ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ
- Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÑ‚ÑÑ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð´Ð»Ñ Ð±Ð¾Ð»ÑŒÑˆÐ¸Ñ… Ð¿ÐµÑ€Ð¸Ð¾Ð´Ð¾Ð² (>90 Ð´Ð½ÐµÐ¹)
