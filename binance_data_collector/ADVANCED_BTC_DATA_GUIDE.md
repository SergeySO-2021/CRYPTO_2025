# üìä –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Å–±–æ—Ä—É —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ BTC

## üéØ –û–ø–∏—Å–∞–Ω–∏–µ

–°–∫—Ä–∏–ø—Ç—ã –¥–ª—è —Å–±–æ—Ä–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ BTC –≤–∫–ª—é—á–∞—é—Ç:

1. **–¶–µ–Ω–∞ (OHLCV)** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Å–≤–µ—á–∏
2. **–õ–∏–º–∏—Ç–Ω—ã–µ –∑–∞—è–≤–∫–∏** - –æ–±—ä–µ–º—ã –Ω–∞ –≥–ª—É–±–∏–Ω–µ 3%, 8%, 15%, 60% –æ—Ç —Ü–µ–Ω—ã
3. **–†—ã–Ω–æ—á–Ω—ã–µ –æ–±—ä–µ–º—ã** - –æ–±—ä–µ–º—ã –ø–æ–∫—É–ø–æ–∫ –∏ –ø—Ä–æ–¥–∞–∂
4. **–õ–∏–∫–≤–∏–¥–∞—Ü–∏–∏** - –¥–∞–Ω–Ω—ã–µ –æ –ª–∏–∫–≤–∏–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏—è—Ö (long/short)
5. **–û—Ç–∫—Ä—ã—Ç—ã–π –∏–Ω—Ç–µ—Ä–µ—Å** - –æ–±—â–∏–π –æ—Ç–∫—Ä—ã—Ç—ã–π –∏–Ω—Ç–µ—Ä–µ—Å –ø–æ —Ñ—å—é—á–µ—Ä—Å–∞–º

–í—Å–µ –¥–∞–Ω–Ω—ã–µ –∞–≥—Ä–µ–≥–∏—Ä—É—é—Ç—Å—è –ø–æ **15-–º–∏–Ω—É—Ç–Ω—ã–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º**.

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ (collect_advanced_btc_data.py)

–°–∫—Ä–∏–ø—Ç —Å–æ–±–∏—Ä–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ REST API Binance.

**–ö–æ–ª–æ–Ω–∫–∏ –≤ –∏—Ç–æ–≥–æ–≤–æ–º DataFrame:**

#### –ë–∞–∑–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ:
- `open`, `high`, `low`, `close`, `volume` - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ OHLCV –¥–∞–Ω–Ω—ã–µ

#### –†—ã–Ω–æ—á–Ω—ã–µ –æ–±—ä–µ–º—ã:
- `market_buy_volume` - –æ–±—ä–µ–º—ã —Ä—ã–Ω–æ—á–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫ –∑–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª
- `market_sell_volume` - –æ–±—ä–µ–º—ã —Ä—ã–Ω–æ—á–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂ –∑–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª

#### –õ–∏–∫–≤–∏–¥–∞—Ü–∏–∏:
- `long_liquidations` - –æ–±—ä–µ–º—ã –ª–∏–∫–≤–∏–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö long –ø–æ–∑–∏—Ü–∏–π
- `short_liquidations` - –æ–±—ä–µ–º—ã –ª–∏–∫–≤–∏–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö short –ø–æ–∑–∏—Ü–∏–π
- `total_liquidations` - –æ–±—â–∏–π –æ–±—ä–µ–º –ª–∏–∫–≤–∏–¥–∞—Ü–∏–π

#### Order Book Depth (–¥–ª—è –∫–∞–∂–¥–æ–π –≥–ª—É–±–∏–Ω—ã: 3%, 8%, 15%, 60%):
- `bid_volume_3pct` - –æ–±—ä–µ–º –ª–∏–º–∏—Ç–Ω—ã—Ö –∑–∞—è–≤–æ–∫ –Ω–∞ –ø–æ–∫—É–ø–∫—É –Ω–∞ –≥–ª—É–±–∏–Ω–µ 3%
- `ask_volume_3pct` - –æ–±—ä–µ–º –ª–∏–º–∏—Ç–Ω—ã—Ö –∑–∞—è–≤–æ–∫ –Ω–∞ –ø—Ä–æ–¥–∞–∂—É –Ω–∞ –≥–ª—É–±–∏–Ω–µ 3%
- `total_volume_3pct` - –æ–±—â–∏–π –æ–±—ä–µ–º –Ω–∞ –≥–ª—É–±–∏–Ω–µ 3%
- `imbalance_3pct` - –¥–∏—Å–±–∞–ª–∞–Ω—Å (bid - ask) / (bid + ask)
- –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è `8pct`, `15pct`, `60pct`

#### –û—Ç–∫—Ä—ã—Ç—ã–π –∏–Ω—Ç–µ—Ä–µ—Å:
- `open_interest` - –æ—Ç–∫—Ä—ã—Ç—ã–π –∏–Ω—Ç–µ—Ä–µ—Å –≤ BTC
- `open_interest_value` - —Å—Ç–æ–∏–º–æ—Å—Ç—å –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ –∏–Ω—Ç–µ—Ä–µ—Å–∞ –≤ USDT

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –°–±–æ—Ä –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö

```bash
python scripts/collect_advanced_btc_data.py
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:**
- –ü–µ—Ä–∏–æ–¥: —Å 2017-08-01 (–Ω–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã Binance) –¥–æ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã
- –¢–∞–π–º—Ñ—Ä–µ–π–º: 15 –º–∏–Ω—É—Ç
- –¢–æ—Ä–≥–æ–≤–∞—è –ø–∞—Ä–∞: BTCUSDT

**–í–∞–∂–Ω–æ:**
- –°–±–æ—Ä –ø–æ–ª–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ (–Ω–µ—Å–∫–æ–ª—å–∫–æ —á–∞—Å–æ–≤)
- Order book –¥–∞–Ω–Ω—ã–µ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –∫–∞–∫ –æ–±—Ä–∞–∑—Ü—ã (–Ω–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞)
- –î–ª—è –ø–æ–ª–Ω—ã—Ö order book –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

### 2. –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

```bash
python scripts/collect_realtime_advanced_btc.py
```

–°–∫—Ä–∏–ø—Ç:
- –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ WebSocket Binance
- –°–æ–±–∏—Ä–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç –ø–æ 15-–º–∏–Ω—É—Ç–Ω—ã–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –∫–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ü–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ order book –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞
- –ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –¢–æ—á–Ω—ã–π –æ—Ç–∫—Ä—ã—Ç—ã–π –∏–Ω—Ç–µ—Ä–µ—Å

**–û—Å—Ç–∞–Ω–æ–≤–∫–∞:** –ù–∞–∂–º–∏—Ç–µ `Ctrl+C`

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–∞ —Å–±–æ—Ä–∞

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `main()` –≤ —Å–∫—Ä–∏–ø—Ç–µ:

```python
# –ü—Ä–∏–º–µ—Ä: —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –≥–æ–¥
end_date = datetime.now()
start_date = end_date - timedelta(days=365)
```

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –≥–ª—É–±–∏–Ω order book

–í –∫–ª–∞—Å—Å–µ `AdvancedBTCDataCollector` –∏–∑–º–µ–Ω–∏—Ç–µ:

```python
self.depths = [0.03, 0.08, 0.15, 0.60]  # 3%, 8%, 15%, 60%
```

## üìä –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è API Binance

### –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ:
- ‚úÖ OHLCV - –ø–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞
- ‚úÖ Aggregated Trades - –ø–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞
- ‚ö†Ô∏è –õ–∏–∫–≤–∏–¥–∞—Ü–∏–∏ - –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –¥–ª—è —Ñ—å—é—á–µ—Ä—Å–æ–≤, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è
- ‚úÖ –û—Ç–∫—Ä—ã—Ç—ã–π –∏–Ω—Ç–µ—Ä–µ—Å - –∏—Å—Ç–æ—Ä–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ —á–µ—Ä–µ–∑ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π endpoint
- ‚ùå Order Book Depth - –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã, —Ç–æ–ª—å–∫–æ —Ç–µ–∫—É—â–∏–µ —Å–Ω–∏–º–∫–∏

### –î–∞–Ω–Ω—ã–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:
- ‚úÖ –í—Å–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ WebSocket
- ‚úÖ Order Book –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ –õ–∏–∫–≤–∏–¥–∞—Ü–∏–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ –û—Ç–∫—Ä—ã—Ç—ã–π –∏–Ω—Ç–µ—Ä–µ—Å –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

## üíæ –§–æ—Ä–º–∞—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `data/historical/` –∏–ª–∏ `data/realtime/`:

```
BTCUSDT_advanced_15m_YYYYMMDD_YYYYMMDD.csv
```

–§–æ—Ä–º–∞—Ç: CSV —Å –≤—Ä–µ–º–µ–Ω–Ω–æ–π –º–µ—Ç–∫–æ–π –≤ –∏–Ω–¥–µ–∫—Å–µ

## üîß –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- `python-binance>=1.0.19`
- `pandas>=2.0.0`
- `numpy>=1.24.0`
- `requests>=2.28.0`

–£—Å—Ç–∞–Ω–æ–≤–∫–∞:
```bash
pip install -r requirements.txt
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **Order Book –¥–ª—è –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö:**
   - Binance –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏—Å—Ç–æ—Ä–∏—é order book —á–µ—Ä–µ–∑ REST API
   - –°–∫—Ä–∏–ø—Ç —Å–æ–±–∏—Ä–∞–µ—Ç –æ–±—Ä–∞–∑—Ü—ã (samples) order book
   - –î–ª—è –ø–æ–ª–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

2. **–õ–∏–∫–≤–∏–¥–∞—Ü–∏–∏:**
   - –î–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –¥–ª—è —Ñ—å—é—á–µ—Ä—Å–æ–≤ (BTCUSDT futures)
   - –ò—Å—Ç–æ—Ä–∏—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ (–æ–±—ã—á–Ω–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Å—è—Ü–µ–≤)
   - –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ WebSocket –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

3. **–õ–∏–º–∏—Ç—ã API:**
   - –°–æ–±–ª—é–¥–∞–π—Ç–µ –ª–∏–º–∏—Ç—ã Binance API (1200 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É)
   - –°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
   - –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö 429 (rate limit) —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –∑–∞–¥–µ—Ä–∂–∫—É

4. **–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**
   - –°–±–æ—Ä –ø–æ–ª–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏ (—Å 2017 –≥–æ–¥–∞) –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å 2-4 —á–∞—Å–∞
   - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–æ–±–∏—Ä–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ —á–∞—Å—Ç—è–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ –≥–æ–¥–∞–º)

## üìà –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

```python
import pandas as pd
from pathlib import Path

# –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
filepath = Path("binance_data_collector/data/historical/BTCUSDT_advanced_15m_20240101_20241231.csv")
df = pd.read_csv(filepath, index_col=0, parse_dates=True)

# –ê–Ω–∞–ª–∏–∑ –¥–∏—Å–±–∞–ª–∞–Ω—Å–∞ order book
df['ob_imbalance_3pct'] = (df['bid_volume_3pct'] - df['ask_volume_3pct']) / df['total_volume_3pct']

# –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –º–µ–∂–¥—É –ª–∏–∫–≤–∏–¥–∞—Ü–∏—è–º–∏ –∏ —Ü–µ–Ω–æ–π
correlation = df['total_liquidations'].corr(df['close'].pct_change())

print(f"–ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –ª–∏–∫–≤–∏–¥–∞—Ü–∏–π –∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω—ã: {correlation:.4f}")
```

## üÜò –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ "Rate limit exceeded"
- –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –∑–∞–¥–µ—Ä–∂–∫—É
- –ú–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å `REQUEST_DELAY` –≤ `config.py`

### –ü—É—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –ª–∏–∫–≤–∏–¥–∞—Ü–∏—è–º
- –õ–∏–∫–≤–∏–¥–∞—Ü–∏–∏ –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –¥–ª—è —Ñ—å—é—á–µ—Ä—Å–æ–≤
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–∏–º–≤–æ–ª (BTCUSDT)
- –î–ª—è —Å—Ç–∞—Ä—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤ –¥–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã

### –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö order book –≤ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ - Binance –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏—Å—Ç–æ—Ä–∏—é order book
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –ø–æ–ª–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö


